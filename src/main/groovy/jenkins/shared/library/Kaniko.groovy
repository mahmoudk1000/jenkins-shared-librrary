#!/usr/bin/env groovy
/*
* This Groovy source file was generated by the Gradle 'init' task.
*/
package main.groovy.jenkins.shared.library

class Kaniko implements Serializable {
    def script

    Kaniko(script) {
        this.script = script
    }

    def buildPush(String imageName, String tag) {
        def appName = imageName.contains('/') ? imageName.split('/')[1] : ""

        script.sh label: "Build and push image ${imageName}:${tag}",
            script: "/kaniko/executor -f `pwd`/Dockerfile.${appName} --context `pwd` --destination ${imageName}:${tag}"
    }

}
